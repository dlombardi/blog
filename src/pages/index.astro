---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_TITLE } from '../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description="Building systems that scale. Writing about technology, architecture, and software engineering." />
		<style>
			@keyframes glitch {
				0% {
					text-shadow: 2px 0 #ffff00, -2px 0 #ff00de;
					transform: translate(0);
				}
				20% {
					text-shadow: -2px 0 #ffff00, 2px 0 #ff00de;
					transform: translate(-2px, 1px);
				}
				40% {
					text-shadow: 2px 0 #ff00de, -2px 0 #ffff00;
					transform: translate(2px, -1px);
				}
				60% {
					text-shadow: -2px 0 #ff00de, 2px 0 #ffff00;
					transform: translate(1px, 2px);
				}
				80% {
					text-shadow: 2px 0 #ffff00, -2px 0 #ff00de;
					transform: translate(-1px, -2px);
				}
				100% {
					text-shadow: 0 0 transparent;
					transform: translate(0);
				}
			}

			@keyframes fadeIn {
				from { opacity: 0; transform: translateY(10px); }
				to { opacity: 1; transform: translateY(0); }
			}

			main {
				animation: fadeIn 0.6s ease-out;
			}

			.header {
				margin-bottom: 4rem;
			}

			.name {
				font-size: 1.5rem;
				font-weight: 900;
				margin-bottom: 0.5rem;
				letter-spacing: -0.02em;
				display: inline-block;
				cursor: default;
				transition: transform 0.1s ease;
			}

			.name:hover {
				animation: glitch 0.3s ease-in-out;
			}

			.socials {
				display: flex;
				gap: 1.5rem;
				font-size: 0.875rem;
			}

			.socials a {
				color: var(--gray);
				text-decoration: none;
				transition: color 0.2s ease;
			}

			.socials a:hover {
				color: #ffff00;
				opacity: 1;
			}

			.posts-list {
				list-style: none;
				padding: 0;
				margin: 0;
			}

			.post-item {
				margin-bottom: 3rem;
				border-bottom: 1px solid var(--gray-light);
				padding-bottom: 3rem;
			}

			.post-item:last-child {
				border-bottom: none;
			}

			.post-link {
				text-decoration: none;
				display: block;
				transition: transform 0.2s ease;
			}

			.post-link:hover {
				transform: translateX(4px);
			}

			.post-date {
				font-family: var(--font-mono);
				font-size: 0.875rem;
				color: var(--gray);
				margin-bottom: 0.5rem;
			}

			.post-title {
				font-size: clamp(1.75rem, 4vw, 2.5rem);
				margin: 0 0 0.75rem 0;
				line-height: 1.2;
			}

			.post-description {
				color: var(--gray);
				margin: 0;
			}

			@media (max-width: 768px) {
				.header {
					margin-bottom: 2rem;
				}

				.post-item {
					margin-bottom: 2rem;
					padding-bottom: 2rem;
				}
			}
		</style>
	</head>
	<body>
		<main>
			<header class="header">
				<div class="name">Darien Lombardi</div>
				<div class="socials">
					<a href="https://github.com/yourusername" target="_blank" rel="noopener noreferrer">GitHub</a>
					<a href="https://twitter.com/yourusername" target="_blank" rel="noopener noreferrer">Twitter</a>
				</div>
			</header>
			<ul class="posts-list">
				{
					posts.map((post) => (
						<li class="post-item">
							<a href={`/blog/${post.id}/`} class="post-link">
								<div class="post-date">
									<FormattedDate date={post.data.pubDate} />
								</div>
								<h2 class="post-title">{post.data.title}</h2>
								{post.data.description && (
									<p class="post-description">{post.data.description}</p>
								)}
							</a>
						</li>
					))
				}
			</ul>
		</main>
	</body>
</html>
