---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_TITLE } from '../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description="Building systems that scale. Writing about technology, architecture, and software engineering." />
		<style>
			@keyframes fadeIn {
				from { opacity: 0; }
				to { opacity: 1; }
			}

			@keyframes gridPulse {
				0%, 100% { opacity: 0.05; }
				50% { opacity: 0.15; }
			}

			main {
				animation: fadeIn 0.8s ease-out;
			}

			/* Technical corner markers */
			main::before,
			main::after {
				content: '';
				position: absolute;
				width: 30px;
				height: 30px;
				border: 2px solid var(--accent);
			}

			main::before {
				top: 0;
				left: 0;
				border-right: none;
				border-bottom: none;
			}

			main::after {
				bottom: 0;
				right: 0;
				border-left: none;
				border-top: none;
			}

			.header {
				margin-bottom: 4rem;
				position: relative;
				padding-bottom: 2rem;
				border-bottom: 1px solid rgba(255, 255, 255, 0.1);
			}

			.name {
				font-size: 1.5rem;
				font-weight: 700;
				margin-bottom: 0.5rem;
				letter-spacing: 0.05em;
				font-family: var(--font-mono);
				text-transform: uppercase;
				position: relative;
			}

			.name::before {
				content: '●';
				color: var(--accent);
				margin-right: 0.5rem;
				font-size: 0.5em;
				vertical-align: middle;
			}

			.socials {
				display: flex;
				gap: 2rem;
				font-size: 0.8rem;
				font-family: var(--font-mono);
			}

			.socials a {
				color: var(--gray);
				text-decoration: none;
				transition: all 0.2s ease;
				position: relative;
				padding: 0.25rem 0.5rem;
				border: 1px solid transparent;
			}

			.socials a:hover {
				color: var(--accent);
				border: 1px solid var(--accent);
				background: rgba(0, 255, 136, 0.05);
			}

			.posts-list {
				list-style: none;
				padding: 0;
				margin: 0;
			}

			.post-item {
				margin-bottom: 3rem;
				padding-bottom: 3rem;
				border-bottom: 1px solid rgba(255, 255, 255, 0.05);
				position: relative;
				padding-left: 2.5rem;
			}

			.post-item::before {
				content: '';
				position: absolute;
				left: 0;
				top: 0;
				bottom: 0;
				width: 2px;
				background: linear-gradient(to bottom, var(--accent), transparent);
			}

			.post-item::after {
				content: attr(data-index);
				position: absolute;
				left: -0.5rem;
				top: 0;
				font-size: 0.75rem;
				color: var(--gray);
				font-family: var(--font-mono);
				background: var(--white);
				padding: 0 0.25rem;
			}

			.post-item:last-child {
				border-bottom: none;
			}

			.post-link {
				text-decoration: none;
				display: block;
				transition: all 0.2s ease;
				position: relative;
			}

			.post-link:hover {
				padding-left: 0.5rem;
			}

			.post-link:hover .post-title {
				color: var(--accent);
			}

			.post-date {
				font-family: var(--font-mono);
				font-size: 0.75rem;
				color: var(--gray);
				margin-bottom: 0.75rem;
				letter-spacing: 0.05em;
				text-transform: uppercase;
			}

			.post-date::before {
				content: '→ ';
				color: var(--accent);
			}

			.post-title {
				font-size: clamp(1.25rem, 3vw, 1.75rem);
				margin: 0 0 0.75rem 0;
				line-height: 1.3;
				font-family: var(--font-mono);
				font-weight: 700;
				letter-spacing: 0.02em;
				transition: color 0.2s ease;
			}

			.post-description {
				color: var(--gray);
				margin: 0;
				font-size: 0.9rem;
				line-height: 1.6;
			}

			@media (max-width: 768px) {
				.header {
					margin-bottom: 2rem;
				}

				.post-item {
					margin-bottom: 2rem;
					padding-bottom: 2rem;
					padding-left: 1.5rem;
				}

				.socials {
					flex-direction: column;
					gap: 1rem;
				}
			}
		</style>
	</head>
	<body>
		<main>
			<header class="header">
				<div class="name">Darien Lombardi</div>
				<div class="socials">
					<a href="https://github.com/dlombardi" target="_blank" rel="noopener noreferrer">GitHub</a>
					<a href="https://x.com/DarienLombardi" target="_blank" rel="noopener noreferrer">Twitter</a>
					<a href="https://www.linkedin.com/in/darienlombardi/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
				</div>
			</header>
			<ul class="posts-list">
				{
					posts.map((post, index) => (
						<li class="post-item" data-index={`${String(index + 1).padStart(2, '0')}`}>
							<a href={`/blog/${post.id}/`} class="post-link">
								<div class="post-date">
									<FormattedDate date={post.data.pubDate} />
								</div>
								<h2 class="post-title">{post.data.title}</h2>
								{post.data.description && (
									<p class="post-description">{post.data.description}</p>
								)}
							</a>
						</li>
					))
				}
			</ul>
		</main>
	</body>
</html>
